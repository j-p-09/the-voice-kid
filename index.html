<!DOCTYPE html>
<html lang="sl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Voice Kids Simulator</title>
    <style>
        :root {
            --red: #ff0000;
            --dark-red: #8b0000;
            --gold: #ffd700;
            --bg: #050505;
        }

        body {
            margin: 0;
            background-color: var(--bg);
            color: white;
            font-family: 'Arial Black', sans-serif;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            height: 100vh;
        }

        /* ODER IN VIDEO */
        #stage {
            flex: 1;
            position: relative;
            background: radial-gradient(circle, #222 0%, #000 100%);
            display: flex;
            justify-content: center;
            align-items: center;
        }

        #video-wrapper {
            width: 80%;
            height: 80%;
            border: 5px solid #222;
            box-shadow: 0 0 50px rgba(255,0,0,0.2);
            position: relative;
        }

        #player {
            width: 100%;
            height: 100%;
        }

        /* SISTEM STOLOV */
        #chairs-container {
            height: 250px;
            background: linear-gradient(to bottom, #111, #000);
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 40px;
            perspective: 1000px;
            padding-bottom: 20px;
        }

        .chair-wrapper {
            position: relative;
            width: 120px;
            height: 180px;
            transition: transform 1.2s cubic-bezier(0.4, 0, 0.2, 1);
            transform-style: preserve-3d;
        }

        /* Ko se stol obrne */
        .chair-wrapper.turned {
            transform: rotateY(180deg);
        }

        .chair-front, .chair-back {
            position: absolute;
            width: 100%;
            height: 100%;
            backface-visibility: hidden;
            border-radius: 15px 15px 5px 5px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            border: 2px solid #333;
        }

        /* Hrbtna stran stola (ko gledaš v občinstvo) */
        .chair-back {
            background: linear-gradient(#444, #111);
            color: #222;
            font-size: 10px;
        }

        .chair-back::after {
            content: "";
            width: 80%;
            height: 60%;
            background: #222;
            border-radius: 10px;
        }

        /* Sprednja stran stola (ko gledaš peca) */
        .chair-front {
            background: linear-gradient(var(--dark-red), #222);
            transform: rotateY(180deg);
        }

        .i-want-you-text {
            color: white;
            font-size: 14px;
            text-align: center;
            font-weight: bold;
            display: none;
            text-shadow: 0 0 10px var(--red);
        }

        .turned .i-want-you-text {
            display: block;
            animation: blink 0.5s infinite;
        }

        /* BUZZER GUMB */
        #main-buzzer-container {
            position: absolute;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            z-index: 100;
        }

        #buzzer {
            width: 100px;
            height: 100px;
            background: radial-gradient(#ff4d4d, #990000);
            border-radius: 50%;
            border: 5px solid #333;
            box-shadow: 0 8px 0 #660000, 0 15px 20px rgba(0,0,0,0.5);
            cursor: pointer;
            active: transform: translateY(4px);
        }

        #buzzer:active {
            transform: translateY(4px);
            box-shadow: 0 4px 0 #660000, 0 8px 10px rgba(0,0,0,0.5);
        }

        #buzzer.disabled {
            filter: grayscale(1);
            cursor: not-allowed;
        }

        /* OVERLAYS */
        #overlay {
            position: absolute;
            top:0; left:0; width:100%; height:100%;
            background: rgba(0,0,0,0.9);
            z-index: 1000;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
        }

        .btn-start {
            padding: 20px 50px;
            background: var(--red);
            color: white;
            border: none;
            font-size: 24px;
            cursor: pointer;
            border-radius: 50px;
            box-shadow: 0 0 20px var(--red);
        }

        @keyframes blink {
            50% { opacity: 0.3; }
        }

        .info {
            position: absolute;
            top: 10px;
            left: 10px;
            font-size: 14px;
            color: #666;
        }
    </style>
</head>
<body>

    <div id="overlay">
        <h1>THE VOICE KIDS</h1>
        <p>Simulator Sodnika</p>
        <button class="btn-start" onclick="initShow()">PRIPRAVI ODER</button>
    </div>

    <div class="info">Status: <span id="game-status">Pripravljen</span> | Ekipa: <span id="team-count">0</span></div>

    <div id="stage">
        <div id="video-wrapper">
            <div id="player"></div>
        </div>
        
        <div id="main-buzzer-container">
            <div id="buzzer" onclick="handlePlayerChoice()"></div>
        </div>
    </div>

    <div id="chairs-container">
        <div class="chair-wrapper" id="chair-1">
            <div class="chair-back"></div>
            <div class="chair-front"><div class="i-want-you-text">I WANT YOU</div></div>
        </div>

        <div class="chair-wrapper" id="chair-2">
            <div class="chair-back"></div>
            <div class="chair-front"><div class="i-want-you-text">I WANT YOU</div></div>
        </div>

        <div class="chair-wrapper" id="chair-player">
            <div class="chair-back" style="border-color: var(--red);"></div>
            <div class="chair-front" style="background: linear-gradient(#ff0000, #440000);"><div class="i-want-you-text">MOJA EKIPA</div></div>
        </div>

        <div class="chair-wrapper" id="chair-3">
            <div class="chair-back"></div>
            <div class="chair-front"><div class="i-want-you-text">I WANT YOU</div></div>
        </div>
    </div>

    <script>
        // Seznam pravih Voice Kids nastopov
        const playlist = [
            "M0XQz9tQ8V4", // Mimi - Dance Monkey
            "uV2Xh6rP2bU", // Laura - I Will Always Love You
            "e1y7cQ4L7wA", // Tilman - Bohemian Rhapsody
            "I5z0W-r4kC0", // Chelsea - Girl on Fire
            "f2v4_q8P1n0", // Shallow
            "7S-S7v9uXN0", // Courtney Hadwin
            "Z6Xm09aGf40", // Solomia - Time to say goodbye
            "84S-G_2fH0Q", // Celine Dion cover
        ];

        let player;
        let currentTrack = 0;
        let hasTurned = false;
        let teamSize = 0;
        let robotTurns = [false, false, false];

        // 1. Naloži YouTube API
        var tag = document.createElement('script');
        tag.src = "https://www.youtube.com/iframe_api";
        var firstScriptTag = document.getElementsByTagName('script')[0];
        firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);

        function onYouTubeIframeAPIReady() {
            // Player se ustvari, a se ne zažene takoj
            player = new YT.Player('player', {
                height: '100%',
                width: '100%',
                videoId: playlist[currentTrack],
                playerVars: {
                    'autoplay': 0,
                    'controls': 0,
                    'modestbranding': 1,
                    'rel': 0
                },
                events: {
                    'onReady': onPlayerReady,
                    'onStateChange': onPlayerStateChange
                }
            });
        }

        function initShow() {
            document.getElementById('overlay').style.display = 'none';
            player.playVideo();
            startNewCandidate();
        }

        function onPlayerReady(event) {
            // Pripravljeno
        }

        function startNewCandidate() {
            hasTurned = false;
            robotTurns = [false, false, false];
            
            // Ponastavi stole
            document.querySelectorAll('.chair-wrapper').forEach(c => c.classList.remove('turned'));
            document.getElementById('buzzer').classList.remove('disabled');
            document.getElementById('game-status').innerText = "Avdicije na slepo...";

            // Naključni časi za robote (med 10 in 60 sekund)
            for(let i=1; i<=3; i++) {
                let randomTime = Math.floor(Math.random() * 50000) + 10000;
                setTimeout(() => {
                    if(!hasTurned && robotTurns[i-1] === false) {
                        turnRobot(i);
                    }
                }, randomTime);
            }
        }

        function turnRobot(num) {
            if(player.getPlayerState() !== 1) return; // Samo če video teče
            robotTurns[num-1] = true;
            document.getElementById('chair-' + num).classList.add('turned');
        }

        function handlePlayerChoice() {
            if(hasTurned) return;

            const currentTime = player.getCurrentTime();
            const duration = player.getDuration();

            // Preveri 15s pravilo
            if(duration - currentTime < 15) {
                alert("Prepozno! Nastop se končuje.");
                return;
            }

            hasTurned = true;
            teamSize++;
            document.getElementById('team-count').innerText = teamSize;
            document.getElementById('chair-player').classList.add('turned');
            document.getElementById('buzzer').classList.add('disabled');
            document.getElementById('game-status').innerText = "DOBIL SI GA!";
        }

        function onPlayerStateChange(event) {
            // Ko se pesem konča
            if (event.data == YT.PlayerState.ENDED) {
                currentTrack++;
                if(currentTrack < playlist.length) {
                    player.loadVideoById(playlist[currentTrack]);
                    startNewCandidate();
                } else {
                    document.getElementById('game-status').innerText = "KONEC SEZONE";
                    alert("Sezona zaključena! Tvoja ekipa šteje " + teamSize + " pevcov.");
                }
            }

            // Nenehno preverjanje časa za 15s pravilo
            setInterval(() => {
                if(player && player.getCurrentTime) {
                    let rem = player.getDuration() - player.getCurrentTime();
                    if(rem < 15 && rem > 0 && !hasTurned) {
                        // Samodejno obrni vse ob koncu, če igralec ni pritisnil
                        document.querySelectorAll('.chair-wrapper').forEach(c => c.classList.add('turned'));
                        document.getElementById('buzzer').classList.add('disabled');
                        document.getElementById('game-status').innerText = "Konec nastopa...";
                    }
                }
            }, 1000);
        }
    </script>
</body>
</html>
